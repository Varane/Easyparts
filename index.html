<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sonver · Repuestos Usados</title>

  <!-- Favicon and preload logo +-->
  <link rel="preload" as="image" href="/logo.png" />
  <link rel="icon" type="image/png" href="/logo.png" />
  <link rel="apple-touch-icon" href="/logo.png" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;
      color: #0f172a;
      min-height: 100vh;
      position: relative;
      background:
        radial-gradient(circle at 20% 18%, rgba(22, 81, 137, 0.18), transparent 42%),
        radial-gradient(circle at 76% 26%, rgba(17, 46, 80, 0.16), transparent 44%),
        linear-gradient(180deg, rgba(5, 22, 45, 0.78) 0%, rgba(9, 36, 67, 0.92) 100%);
    }

    /* BACKGROUND WITH OVERLAY */
    .background-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background-image: url('background.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-repeat: no-repeat;
    }

    .background-wrapper::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(185deg, rgba(7, 23, 46, 0.62) 0%, rgba(9, 35, 68, 0.68) 60%, rgba(6, 26, 53, 0.78) 100%);
    }

    /* Fade Animation */
    .fade {
      opacity: 0;
      animation: fadein 0.8s ease forwards;
    }

    @keyframes fadein {
      to { opacity: 1; transform: translateY(0); }
      from { opacity: 0; transform: translateY(10px); }
    }

    /* Language Switcher */
    .lang-switch-wrapper {
      position: fixed;
      top: 14px;
      right: 14px;
      z-index: 100;
    }

    .lang-switch {
      display: flex;
      gap: 4px;
      background: rgba(246, 250, 253, 0.92);
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid rgba(30, 84, 136, 0.2);
      box-shadow: 0 10px 22px rgba(16, 50, 92, 0.2);
      backdrop-filter: blur(10px);
    }

    .lang-switch button {
      border: none;
      background: #e8f0f8;
      border-radius: 999px;
      padding: 4px 10px;
      cursor: pointer;
      font-size: 11px;
      color: #24292f;
      transition: all 0.15s;
      font-weight: 500;
    }

    .lang-switch button.active {
      background: #1e6fb6;
      color: #ffffff;
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(30, 111, 182, 0.28);
    }

    .lang-switch button:hover:not(.active) {
      background: #e1e8f0;
    }

    /* Hero Section */
    .hero {
      max-width: 950px;
      background: rgba(245, 249, 253, 0.95);
      border: 2px solid rgba(32, 92, 150, 0.14);
      border-radius: 12px;
      padding: 38px;
      margin: 80px auto 40px auto;
      box-shadow: 0 24px 60px rgba(6, 23, 44, 0.35);
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      backdrop-filter: blur(10px);
    }

    .left {
      padding-right: 25px;
      border-right: 2px solid rgba(32, 92, 150, 0.16);
    }

    .brand {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      background: rgba(28, 88, 144, 0.12);
      padding: 10px 14px;
      border-radius: 14px;
      border: 1px solid rgba(23, 72, 122, 0.16);
    }

    .logo-img {
      width: 124px;
      height: auto;
      display: block;
      filter: drop-shadow(0 8px 14px rgba(2, 15, 34, 0.22));
    }

    .logo-text {
      font-size: 32px;
      font-weight: 800;
      color: #0f2f55;
      letter-spacing: -0.5px;
      text-transform: uppercase;
    }

    .live {
      margin-top: 8px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: #e6eff8;
      padding: 6px 14px;
      border-radius: 20px;
      border: 1px solid rgba(31, 90, 147, 0.26);
      font-size: 12px;
      color: #185083;
    }

    .dot {
      width: 8px;
      height: 8px;
      background: #4ade80;
      border-radius: 50%;
      animation: pulse 2s infinite;
      box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.5);
    }

    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
      50% { box-shadow: 0 0 0 6px rgba(76, 175, 80, 0); }
    }

    .headline {
      margin-top: 20px;
      font-size: 26px;
      font-weight: 760;
      line-height: 1.32;
      color: #0b1f3d;
    }

    .sub {
      margin-top: 12px;
      font-size: 14px;
      line-height: 1.6;
      color: #3f4a5a;
    }

    .form-box {
      padding-left: 25px;
    }

    form {
      display: grid;
      gap: 14px;
    }

    input, textarea {
      width: 100%;
      padding: 11px 14px;
      font-size: 14px;
      border: 2px solid #cdd9e8;
      background: #f5f7fb;
      border-radius: 8px;
      outline: none;
      color: #1b1f23;
      transition: all 0.2s;
      font-family: inherit;
    }

    input:focus, textarea:focus {
      border-color: #1e6fb6;
      box-shadow: 0 0 0 3px rgba(30, 111, 182, 0.16);
      background: #ffffff;
    }

    textarea {
      min-height: 70px;
      resize: vertical;
    }

    input[type="file"] {
      padding: 10px;
      background: #ffffff;
      cursor: pointer;
      font-size: 13px;
    }

    .hint {
      font-size: 11px;
      color: #4d5867;
      margin-top: -8px;
      margin-bottom: 4px;
    }

    /* Upload Status */
    .upload-status {
      display: none;
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 4px;
      margin-top: -8px;
    }

    .upload-status.uploading {
      background: #fef3c7;
      color: #854d0e;
      border: 1px solid #facc15;
    }

    .upload-status.success {
      background: #d9f99d;
      color: #3f6212;
      border: 1px solid #84cc16;
    }

    .upload-status.error {
      background: #fee2e2;
      color: #991b1b;
      border: 1px solid #ef4444;
    }

    button[type="submit"] {
      padding: 13px;
      background: linear-gradient(135deg, #1e6fb6 0%, #184b85 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 650;
      cursor: pointer;
      transition: all 0.15s;
      position: relative;
      overflow: hidden;
    }

    button[type="submit"]:hover:not(:disabled) {
      background: linear-gradient(135deg, #1f7bc8 0%, #17406c 100%);
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(22, 79, 135, 0.32);
    }

    button[type="submit"]:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .thankyou {
      padding: 20px;
      border-radius: 12px;
      border: 2px solid #67c587;
      background: #e7f8ef;
      text-align: center;
    }

    .thankyou h3 {
      color: #1f9d67;
      margin-bottom: 8px;
    }

    /* Sections */
    section {
      margin: 60px auto;
      max-width: 1100px;
      padding: 0 20px;
    }

    h2.section-title {
      font-size: 30px;
      text-align: center;
      margin-bottom: 10px;
      color: #ffffff;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .section-sub {
      text-align: center;
      color: #f0f0f0;
      margin-bottom: 40px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    .cards {
      display: flex;
      gap: 26px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .card, .step {
      background: rgba(246, 250, 253, 0.95);
      border: 1px solid rgba(23, 64, 104, 0.1);
      border-radius: 14px;
      padding: 24px 20px;
      width: 250px;
      text-align: center;
      box-shadow: 0 14px 28px rgba(4, 20, 42, 0.18);
      transition: transform 0.2s, box-shadow 0.2s;
      backdrop-filter: blur(10px);
    }

    .card:hover, .step:hover {
      transform: translateY(-4px);
      box-shadow: 0 14px 34px rgba(0, 0, 0, 0.22);
    }

    .icon {
      width: 40px;
      height: 40px;
      margin: 0 auto 16px;
      color: #1e6fb6;
    }

    .card h3, .step h3 {
      font-size: 17px;
      margin-bottom: 10px;
      color: #0b1f3d;
    }

    .card p, .step p {
      font-size: 13px;
      color: #3f4a5a;
      line-height: 1.5;
    }

    .step {
      position: relative;
      padding-top: 40px;
    }

    .step-number {
      background: #1e6fb6;
      color: white;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 0 4px 10px rgba(18, 71, 118, 0.3);
    }

    /* About / Privacy */
    .info-section {
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .info-card {
      background: rgba(246, 250, 253, 0.95);
      border: 1px solid rgba(23, 64, 104, 0.1);
      border-radius: 12px;
      padding: 28px;
      box-shadow: 0 10px 30px rgba(6, 23, 44, 0.18);
      backdrop-filter: blur(10px);
    }

    .info-card p {
      font-size: 15px;
      line-height: 1.65;
      color: #1f2937;
    }

    .privacy-block .info-card {
      background: rgba(232, 240, 248, 0.88);
      border-color: rgba(23, 64, 104, 0.08);
    }

    .privacy-block .privacy-text {
      font-size: 12px;
      color: #3f4a5a;
      opacity: 0.7;
    }

    /* Footer */
    footer {
      background: rgba(7, 33, 62, 0.94);
      color: white;
      padding: 30px 20px;
      text-align: center;
      margin-top: 60px;
      font-size: 13px;
      backdrop-filter: blur(10px);
    }

    .invalid-input {
      border-color: #ef4444;
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.15);
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .hero {
        grid-template-columns: 1fr;
        margin: 70px 10px 30px;
        padding: 25px;
        gap: 0;
      }

      .left {
        padding-right: 0;
        padding-bottom: 20px;
        margin-bottom: 20px;
        border-right: none;
        border-bottom: 2px solid #c6d0da;
      }

      .form-box {
        padding-left: 0;
      }

      .card, .step {
        width: 100%;
        max-width: 340px;
      }

      h2.section-title {
        font-size: 24px;
      }

      .brand {
        gap: 8px;
      }

      .logo-img {
        width: 100px;
      }

      .logo-text {
        font-size: 28px;
      }
    }
  </style>
</head>
<body>
  <!-- Background with overlay -->
  <div class="background-wrapper"></div>

  <!-- Language Switcher -->
  <div class="lang-switch-wrapper fade">
    <div class="lang-switch">
      <button data-lang="es" class="active">ES</button>
      <button data-lang="en">EN</button>
      <button data-lang="de">DE</button>
      <button data-lang="lt">LT</button>
      <button data-lang="fr">FR</button>
      <button data-lang="it">IT</button>
      <button data-lang="pt">PT</button>
    </div>
  </div>

  <!-- Hero Section -->
  <div class="hero fade">
    <div class="left">
      <div class="brand">
        <img id="brandLogo" src="/logo.png" alt="Sonver logo" class="logo-img" />
        <div class="logo-text">SONVER</div>
      </div>

      <div class="live">
        <div class="dot"></div>
        <span class="live-text">Disponible · Respuesta rápida</span>
      </div>

      <div class="headline">
        Piezas que llegan. Problemas que se van.
      </div>

      <div class="sub">
        Repuestos originales usados con entrega directa al taller.
      </div>
    </div>

    <div class="form-box">
      <form id="sonver-form">
        <input type="text" id="company" placeholder="Taller o empresa" required>
        <input type="text" id="address" placeholder="Dirección del taller (calle, ciudad, isla)" required>
        <input type="text" id="model" placeholder="Marca y modelo" required>
        <input type="text" id="vin" placeholder="VIN (número de bastidor)" required>
        <textarea id="part" placeholder="Pieza que necesitas (lado, referencia, etc.)" required></textarea>
        <input type="text" id="contact" placeholder="Tu contacto (email, teléfono o nota)" required autocomplete="on" inputmode="text" spellcheck="false">
        <div class="hint">Deja cualquier dato de contacto y te respondemos con precio y disponibilidad.</div>
        <input type="file" id="file" accept="image/*,application/pdf">
        <div class="upload-status" id="uploadStatus"></div>
        <button type="submit">
          <span class="btn-text">Enviar solicitud</span>
        </button>
      </form>
    </div>
  </div>

  <!-- Why Choose Us -->
  <section class="fade">
    <h2 class="section-title">Por qué elegirnos</h2>
    <p class="section-sub">Hacemos que encontrar piezas usadas sea rápido y sencillo gracias a nuestra red.</p>

    <div class="cards">
      <div class="card">
        <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 2.5c-3.59 0-6.5 2.86-6.5 6.4 0 4.8 6.5 11 6.5 11s6.5-6.2 6.5-11c0-3.54-2.91-6.4-6.5-6.4Zm0 9a2.6 2.6 0 1 1 0-5.2 2.6 2.6 0 0 1 0 5.2Z"/>
          <path d="M19.5 19.5 17 17" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
        </svg>
        <h3>La encontramos por ti</h3>
        <p>No encuentras la pieza? La buscamos dentro de nuestra red.</p>
      </div>

      <div class="card">
        <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 3.5c-4.7 0-8.5 3.76-8.5 8.4 0 4.65 3.8 8.4 8.5 8.4 1.18 0 2.3-.23 3.32-.65l2.08.75a1 1 0 0 0 1.3-1.08l-.26-1.56a8.17 8.17 0 0 0 2.06-5.86c0-4.64-3.8-8.4-8.5-8.4Zm-.75 3.1a1 1 0 0 1 1.5.86v3.7l1.82-1.1a1 1 0 1 1 1.02 1.72l-3.2 1.93a1 1 0 0 1-1.54-.85Z"/>
        </svg>
        <h3>Respuesta rápida</h3>
        <p>Disponibilidad y precio en menos de 24 horas.</p>
      </div>

      <div class="card">
        <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
          <path d="M13.4 4.4a2 2 0 0 0-1.4-.6H6.6A2.6 2.6 0 0 0 4 6.4v5.4c0 .53.21 1.04.59 1.41l6.6 6.54a2 2 0 0 0 2.82-.03l3.99-4a2 2 0 0 0 0-2.83Zm-4.9 5.85a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5Z"/>
          <path d="M19.5 11.5 13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        <h3>Precios competitivos</h3>
        <p>Acceso a piezas usadas con precios ajustados al mercado.</p>
      </div>

      <div class="card">
        <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
          <path d="M15 6.5H4.8A1.8 1.8 0 0 0 3 8.3v6.4c0 .99.81 1.8 1.8 1.8h1.04a2.7 2.7 0 0 1 5.32 0H12a2 2 0 0 0 2-2V8.3c0-.99-.8-1.8-1.8-1.8Z"/>
          <path d="M14 10.2h4.07a1.6 1.6 0 0 1 1.3.67l1.36 1.9a1.6 1.6 0 0 1 .27.88v3.05a1.6 1.6 0 0 1-1.6 1.6h-.83a2.4 2.4 0 1 1-4.8 0H11.3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          <path d="M8.7 17.3a2.4 2.4 0 1 1-4.8 0 2.4 2.4 0 0 1 4.8 0Z"/>
          <path d="M20.6 17.3a2.4 2.4 0 1 1-4.8 0 2.4 2.4 0 0 1 4.8 0Z"/>
        </svg>
        <h3>Red amplia</h3>
        <p>Trabajamos con una red amplia de transportistas para entregas a talleres en toda Europa.</p>
      </div>
    </div>
  </section>

  <!-- How it Works -->
  <section class="fade">
    <h2 class="section-title">Cómo funciona</h2>
    <p class="section-sub">Conseguir la pieza correcta es tan fácil como 1, 2, 3.</p>

    <div class="cards">
      <div class="step">
        <div class="step-number">1</div>
        <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
          <path d="M9.5 4.5h5a2 2 0 0 1 2 2V17a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2V6.5a2 2 0 0 1 2-2Z"/>
          <path d="M10 8h4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M9 12.5 11 14l4-4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <h3>Envíanos tu solicitud</h3>
        <p>Indica la pieza, el VIN y los datos básicos del vehículo.</p>
      </div>

      <div class="step">
        <div class="step-number">2</div>
        <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="6.5" fill="none" stroke="currentColor" stroke-width="1.6"/>
          <circle cx="12" cy="12" r="1.6"/>
          <path d="M12 5v2.5M12 16.5V19M5 12h2.5M16.5 12H19" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
        </svg>
        <h3>Buscamos en nuestra red</h3>
        <p>Revisamos miles de referencias en desguaces y proveedores.</p>
      </div>

      <div class="step">
        <div class="step-number">3</div>
        <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
          <path d="M5.8 8.5 12 5l6.2 3.5v6.8L12 18.8 5.8 15.3Z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
          <path d="M9.5 12.25 11.4 14l3.4-3.7" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M4 9v6.5c0 1 .8 1.8 1.8 1.8h12.4c1 0 1.8-.8 1.8-1.8V9" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
        <h3>Recibe la pieza</h3>
        <p>Te contactamos por WhatsApp con precio, plazo y opciones de transporte.</p>
      </div>
    </div>
  </section>

  <!-- About Us -->
  <div class="info-section fade">
    <h2 class="section-title">Sobre nosotros</h2>
    <div class="info-card">
      <p class="about-text">
        Sonver lleva más de 12 años operando en el sector de automoción. Empezamos como especialistas en
        abastecimiento técnico y hoy ayudamos a talleres en toda Europa a encontrar repuestos originales usados de forma
        rápida y fiable. Trabajamos con una red amplia de proveedores y transportistas para que la pieza correcta llegue
        directamente a tu taller.
      </p>
    </div>
  </div>

  <!-- Privacy -->
  <div class="info-section fade privacy-block">
    <h2 class="section-title">Privacidad & GDPR</h2>
    <div class="info-card">
      <p class="privacy-text">
        Responsable: Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Finalidad: responder a tu solicitud y
        enviarte una propuesta. Base legal: medidas precontractuales a petición del interesado e interés legítimo en el
        seguimiento. Conservación: 12 meses desde el último contacto. Destinatarios: no cedemos datos salvo obligación
        legal o proveedores esenciales (hosting/WhatsApp) en el EEE. Derechos: acceso, rectificación, supresión,
        limitación, oposición, portabilidad y reclamación ante la autoridad. Ejercicio de derechos: gdpr@sonver.eu.
      </p>
    </div>
  </div>

  <footer>
    © 2025 — Sonver UAB · Sonver International · Sonver Baltics — Headquarters: Kariu Kapų g. 19, Vilnius
  </footer>

  <!-- Upload & Form Handler -->
  <script type="module">
    // Lightweight logo fallback (ensures the mark renders even if the PNG fails to load)
    const LOGO_FALLBACK = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="56" viewBox="0 0 160 56" fill="none"><rect width="160" height="56" rx="12" fill="%230F2F55"/><text x="80" y="36" text-anchor="middle" fill="white" font-family="Inter, Arial, sans-serif" font-size="28" font-weight="800" letter-spacing="1">SONVER</text></svg>';

    // Upload target (anonymous file host). Replace with your own endpoint if needed.
    const UPLOAD_ENDPOINT = 'https://tmpfiles.org/api/v1/upload';

    // Translation system
    const translations = {
      es: {
        live: "Disponible · Respuesta rápida",
        headline: "Piezas que llegan. Problemas que se van.",
        sub: "Repuestos originales usados con entrega directa al taller.",
        company: "Taller o empresa",
        address: "Dirección del taller (calle, ciudad, isla)",
        model: "Marca y modelo",
        vin: "VIN (número de bastidor)",
        part: "Pieza que necesitas (lado, referencia, etc.)",
        contact: "Tu contacto (email, teléfono o nota)",
        hint: "Deja cualquier dato de contacto y te respondemos con precio y disponibilidad.",
        contactError: "Añade cualquier forma de contacto para responderte.",
        submit: "Enviar solicitud",
        uploading: "Subiendo archivo...",
        uploadSuccess: "Archivo subido correctamente",
        uploadError: "Error al subir archivo",
        thankYouTitle: "¡Gracias!",
        thankYouMsg: "Te contactaremos en breve con precio y disponibilidad.",
        whyTitle: "Por qué elegirnos",
        whySub: "Hacemos que encontrar piezas usadas sea rápido y sencillo gracias a nuestra red.",
        find: "La encontramos por ti",
        findText: "No encuentras la pieza? La buscamos dentro de nuestra red.",
        fast: "Respuesta rápida",
        fastText: "Disponibilidad y precio en menos de 24 horas.",
        price: "Precios competitivos",
        priceText: "Acceso a piezas usadas con precios ajustados al mercado.",
        network: "Red amplia",
        networkText: "Trabajamos con una red amplia de transportistas para entregas a talleres en toda Europa.",
        howTitle: "Cómo funciona",
        howSub: "Conseguir la pieza correcta es tan fácil como 1, 2, 3.",
        step1: "Envíanos tu solicitud",
        step1Text: "Indica la pieza, el VIN y los datos básicos del vehículo.",
        step2: "Buscamos en nuestra red",
        step2Text: "Revisamos miles de referencias en desguaces y proveedores.",
        step3: "Recibe la pieza",
        step3Text: "Te contactamos por WhatsApp con precio, plazo y opciones de transporte.",
        aboutTitle: "Sobre nosotros",
        aboutText: "Sonver lleva más de 12 años operando en el sector de automoción. Empezamos como especialistas en abastecimiento técnico y hoy ayudamos a talleres en toda Europa a encontrar repuestos originales usados de forma rápida y fiable. Trabajamos con una red amplia de proveedores y transportistas para que la pieza correcta llegue directamente a tu taller.",
        privacyTitle: "Privacidad & GDPR",
        privacyText: "Responsable: Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Finalidad: responder a tu solicitud y enviarte una propuesta. Base legal: medidas precontractuales a petición del interesado e interés legítimo en el seguimiento. Conservación: 12 meses desde el último contacto. Destinatarios: no cedemos datos salvo obligación legal o proveedores esenciales (hosting/WhatsApp) en el EEE. Derechos: acceso, rectificación, supresión, limitación, oposición, portabilidad y reclamación ante la autoridad. Ejercicio de derechos: gdpr@sonver.eu."
      },
      en: {
        live: "Available · Fast response",
        headline: "Parts arrive. Problems disappear.",
        sub: "Original used parts delivered directly to the workshop.",
        company: "Workshop or company",
        address: "Workshop address (street, city, island)",
        model: "Make and model",
        vin: "VIN (vehicle identification number)",
        part: "Part you need (side, reference, etc.)",
        contact: "Your contact (email, phone or note)",
        hint: "Leave any contact detail and we'll reply with price and availability.",
        contactError: "Please leave any contact detail so we can reply.",
        submit: "Send request",
        uploading: "Uploading file...",
        uploadSuccess: "File uploaded successfully",
        uploadError: "Upload failed",
        thankYouTitle: "Thank you!",
        thankYouMsg: "We will contact you shortly with price and availability.",
        whyTitle: "Why choose us",
        whySub: "We make finding used parts fast and simple thanks to our network.",
        find: "We find it for you",
        findText: "Can't find the part? We search it within our network.",
        fast: "Fast response",
        fastText: "Availability and price in under 24 hours.",
        price: "Competitive prices",
        priceText: "Access to used parts at market-aligned prices.",
        network: "Wide carrier network",
        networkText: "We work with a wide carrier network to deliver to workshops across Europe.",
        howTitle: "How it works",
        howSub: "Getting the right part is as easy as 1, 2, 3.",
        step1: "Send us your request",
        step1Text: "Tell us the part, VIN and basic vehicle details.",
        step2: "We search our network",
        step2Text: "We check thousands of references across dismantlers and suppliers.",
        step3: "Receive the part",
        step3Text: "We contact you via WhatsApp with price, lead time and shipping options.",
        aboutTitle: "About us",
        aboutText: "Sonver has been active in the automotive sector for more than 12 years. We started as technical sourcing experts and today we help workshops all over Europe find original used parts quickly and reliably. We work with a wide network of suppliers and carriers so that the right part arrives directly at your workshop.",
        privacyTitle: "Privacy & GDPR",
        privacyText: "Controller: Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Purpose: reply to your request and send a proposal. Legal basis: pre-contractual steps at your request and our legitimate interest in follow-up. Retention: 12 months from last contact. Recipients: no sharing except legal obligations or essential processors (hosting/WhatsApp) in the EEA. Rights: access, rectification, erasure, restriction, objection, portability, and complaint to the authority. Exercise your rights at gdpr@sonver.eu."
      },
      de: {
        live: "Verfügbar · Schnelle Antwort",
        headline: "Teile kommen. Probleme gehen.",
        sub: "Original gebrauchte Teile direkt an die Werkstatt geliefert.",
        company: "Werkstatt oder Firma",
        address: "Werkstattadresse (Straße, Stadt, Insel)",
        model: "Marke und Modell",
        vin: "FIN / VIN (Fahrzeug-Ident.-Nr.)",
        part: "Benötigtes Teil (Seite, Referenz, etc.)",
        contact: "Ihr Kontakt (E-Mail, Telefon oder Notiz)",
        hint: "Hinterlassen Sie einen beliebigen Kontakt – wir melden uns mit Preis und Verfügbarkeit.",
        contactError: "Bitte hinterlassen Sie irgendeine Kontaktmöglichkeit.",
        submit: "Anfrage senden",
        uploading: "Datei wird hochgeladen...",
        uploadSuccess: "Datei erfolgreich hochgeladen",
        uploadError: "Upload fehlgeschlagen",
        thankYouTitle: "Vielen Dank!",
        thankYouMsg: "Wir melden uns in Kürze mit Preis und Verfügbarkeit.",
        whyTitle: "Warum uns wählen",
        whySub: "Wir machen die Suche nach Gebrauchtteilen schnell und einfach – dank unseres Netzwerks.",
        find: "Wir finden das Teil für Sie",
        findText: "Sie finden das Teil nicht? Wir suchen es in unserem Netzwerk.",
        fast: "Schnelle Antwort",
        fastText: "Verfügbarkeit und Preis in weniger als 24 Stunden.",
        price: "Wettbewerbsfähige Preise",
        priceText: "Zugang zu Gebrauchtteilen zu marktgerechten Preisen.",
        network: "Weites Speditionsnetz",
        networkText: "Wir arbeiten mit einem breiten Netz von Speditionen und beliefern Werkstätten in ganz Europa.",
        howTitle: "Wie es funktioniert",
        howSub: "Das richtige Teil zu bekommen ist so einfach wie 1, 2, 3.",
        step1: "Senden Sie uns Ihre Anfrage",
        step1Text: "Nennen Sie Teil, FIN/VIN und die wichtigsten Fahrzeugdaten.",
        step2: "Wir suchen in unserem Netzwerk",
        step2Text: "Wir prüfen tausende Referenzen bei Verwertern und Lieferanten.",
        step3: "Teil erhalten",
        step3Text: "Wir melden uns per WhatsApp mit Preis, Lieferzeit und Transportoptionen.",
        aboutTitle: "Über uns",
        aboutText: "Sonver ist seit über 12 Jahren in der Automobilbranche tätig. Wir begannen als Experten für technischen Einkauf und unterstützen heute Werkstätten in ganz Europa dabei, originale Gebrauchtteile schnell und zuverlässig zu finden. Dank unseres breiten Netzwerks aus Lieferanten und Speditionen kommt das richtige Teil direkt in Ihre Werkstatt.",
        privacyTitle: "Datenschutz & DSGVO",
        privacyText: "Verantwortlicher: Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Zweck: Ihre Anfrage beantworten und ein Angebot senden. Rechtsgrundlage: vorvertragliche Maßnahmen auf Ihre Anfrage und unser berechtigtes Interesse an der Nachverfolgung. Speicherdauer: 12 Monate ab letztem Kontakt. Empfänger: keine Weitergabe außer gesetzlicher Pflicht oder erforderlichen Auftragsverarbeitern (Hosting/WhatsApp) im EWR. Rechte: Auskunft, Berichtigung, Löschung, Einschränkung, Widerspruch, Datenübertragbarkeit sowie Beschwerde bei der Aufsichtsbehörde. Rechteausübung: gdpr@sonver.eu."
      },
      lt: {
        live: "Pasiekiami · Greitas atsakymas",
        headline: "Dalys atvyksta. Problemų nelieka.",
        sub: "Naudotos originalios dalys pristatomos tiesiai į servisą.",
        company: "Servisas arba įmonė",
        address: "Serviso adresas (gatvė, miestas, sala)",
        model: "Markė ir modelis",
        vin: "VIN (kėbulo numeris)",
        part: "Reikalinga dalis (pusė, kodas ir pan.)",
        contact: "Jūsų kontaktas (el. paštas, telefonas ar žinutė)",
        hint: "Palikite bet kokį kontaktą – atsiųsime kainą ir pasiūlymą.",
        contactError: "Palikite bet kokį kontaktą, kad galėtume atsakyti.",
        submit: "Siųsti užklausą",
        uploading: "Įkeliamas failas...",
        uploadSuccess: "Failas sėkmingai įkeltas",
        uploadError: "Įkelti nepavyko",
        thankYouTitle: "Ačiū!",
        thankYouMsg: "Netrukus susisieksime su kaina ir galimybe.",
        whyTitle: "Kodėl rinktis mus",
        whySub: "Dėl mūsų tiekėjų tinklo naudotas dalis surasti tampa greita ir paprasta.",
        find: "Dalį surandame už jus",
        findText: "Nerandate detalės? Ieškome jos savo tinkle.",
        fast: "Greitas atsakymas",
        fastText: "Kaina ir galimybė – per mažiau nei 24 valandas.",
        price: "Konkurencingos kainos",
        priceText: "Naudotos dalys už rinkai pritaikytas kainas.",
        network: "Platus vežėjų tinklas",
        networkText: "Dirbame su plačiu vežėjų tinklu ir pristatome į servisus visoje Europoje.",
        howTitle: "Kaip tai veikia",
        howSub: "Tinkamą dalį gauti taip paprasta kaip 1, 2, 3.",
        step1: "Atsiųskite užklausą",
        step1Text: "Parašykite dalį, VIN ir pagrindinius automobilio duomenis.",
        step2: "Ieškome savo tinkle",
        step2Text: "Tikriname tūkstančius pozicijų pas utilizavimo aikšteles ir tiekėjus.",
        step3: "Gaukite dalį",
        step3Text: "Susisiekiame per WhatsApp su kaina, terminu ir transporto variantais.",
        aboutTitle: "Apie mus",
        aboutText: "„Sonver” daugiau nei 12 metų dirba automobilių sektoriuje. Pradėjome kaip techninio tiekimo specialistai, o šiandien padedame servisams visoje Europoje greitai ir patikimai rasti originalias naudotas dalis. Dirbame su plačiu tiekėjų ir vežėjų tinklu, kad tinkama dalis atvyktų tiesiai į jūsų servisą.",
        privacyTitle: "Privatumas & GDPR",
        privacyText: "Duomenų valdytojas: Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Tikslas: atsakyti į užklausą ir pateikti pasiūlymą. Teisinis pagrindas: išankstinės sutarties veiksmai jūsų prašymu ir mūsų teisėtas interesas sekti užklausą. Saugojimas: 12 mėn. nuo paskutinio kontakto. Gavėjai: nedaliname duomenų, išskyrus teisinę prievolę ar būtinus tvarkytojus (hostingas/WhatsApp) EEE viduje. Teisės: susipažinti, taisyti, ištrinti, apriboti, nesutikti, perkelti ir skųsti priežiūros institucijai. Teisių įgyvendinimas: gdpr@sonver.eu."
      },
      fr: {
        live: "Disponible · Réponse rapide",
        headline: "Les pièces arrivent. Les problèmes disparaissent.",
        sub: "Pièces d'origine d'occasion livrées directement à l'atelier.",
        company: "Atelier ou entreprise",
        address: "Adresse de l'atelier (rue, ville, île)",
        model: "Marque et modèle",
        vin: "VIN (numéro de châssis)",
        part: "Pièce recherchée (côté, référence, etc.)",
        contact: "Votre contact (e-mail, téléphone ou note)",
        hint: "Laissez n'importe quel moyen de contact – nous revenons vers vous avec prix et dispo.",
        contactError: "Laissez un moyen de contact pour que nous puissions répondre.",
        submit: "Envoyer la demande",
        uploading: "Téléchargement en cours...",
        uploadSuccess: "Fichier téléchargé avec succès",
        uploadError: "Échec du téléchargement",
        thankYouTitle: "Merci !",
        thankYouMsg: "Nous vous contacterons bientôt avec le prix et la disponibilité.",
        whyTitle: "Pourquoi nous choisir",
        whySub: "Grâce à notre réseau, trouver des pièces d'occasion devient rapide et simple.",
        find: "Nous la trouvons pour vous",
        findText: "Vous ne trouvez pas la pièce ? Nous la cherchons dans notre réseau.",
        fast: "Réponse rapide",
        fastText: "Disponibilité et prix en moins de 24h.",
        price: "Prix compétitifs",
        priceText: "Accès à des pièces d'occasion à des prix alignés sur le marché.",
        network: "Large réseau de transporteurs",
        networkText: "Nous travaillons avec un large réseau de transporteurs pour livrer des ateliers dans toute l'Europe.",
        howTitle: "Comment ça marche",
        howSub: "Obtenir la bonne pièce est aussi simple que 1, 2, 3.",
        step1: "Envoyez-nous votre demande",
        step1Text: "Indiquez la pièce, le VIN et les données principales du véhicule.",
        step2: "Nous cherchons dans notre réseau",
        step2Text: "Nous vérifions des milliers de références chez démolisseurs et fournisseurs.",
        step3: "Recevez la pièce",
        step3Text: "Nous vous contactons sur WhatsApp avec prix, délais et options de transport.",
        aboutTitle: "À propos",
        aboutText: "Sonver opère dans le secteur automobile depuis plus de 12 ans. Nous avons commencé comme spécialistes du sourcing technique et nous aidons aujourd'hui des ateliers dans toute l'Europe à trouver des pièces d'origine d'occasion rapidement et de manière fiable. Grâce à un vaste réseau de fournisseurs et de transporteurs, la bonne pièce arrive directement dans votre atelier.",
        privacyTitle: "Confidentialité & RGPD",
        privacyText: "Responsable de traitement : Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Finalité : répondre à votre demande et envoyer une offre. Base légale : mesures précontractuelles à votre demande et intérêt légitime de suivi. Conservation : 12 mois après le dernier contact. Destinataires : aucune communication sauf obligation légale ou sous-traitants essentiels (hébergement/WhatsApp) situés dans l’EEE. Droits : accès, rectification, effacement, limitation, opposition, portabilité et recours auprès de l’autorité. Exercice des droits : gdpr@sonver.eu."
      },
      it: {
        live: "Disponibile · Risposta rapida",
        headline: "I ricambi arrivano. I problemi spariscono.",
        sub: "Ricambi originali usati consegnati direttamente in officina.",
        company: "Officina o azienda",
        address: "Indirizzo officina (via, città, isola)",
        model: "Marca e modello",
        vin: "VIN (numero di telaio)",
        part: "Ricambio richiesto (lato, riferimento, ecc.)",
        contact: "Il tuo contatto (email, telefono o nota)",
        hint: "Lascia qualsiasi contatto – ti rispondiamo con prezzo e disponibilità.",
        contactError: "Lascia qualunque contatto per poterti rispondere.",
        submit: "Invia richiesta",
        uploading: "Caricamento file...",
        uploadSuccess: "File caricato con successo",
        uploadError: "Caricamento fallito",
        thankYouTitle: "Grazie!",
        thankYouMsg: "Ti contatteremo a breve con prezzo e disponibilità.",
        whyTitle: "Perché sceglierci",
        whySub: "Grazie alla nostra rete, trovare ricambi usati è rapido e semplice.",
        find: "La troviamo noi per te",
        findText: "Non trovi il ricambio? Lo cerchiamo nella nostra rete.",
        fast: "Risposta rapida",
        fastText: "Disponibilità e prezzo in meno di 24 ore.",
        price: "Prezzi competitivi",
        priceText: "Accesso a ricambi usati con prezzi in linea col mercato.",
        network: "Ampia rete di trasportatori",
        networkText: "Lavoriamo con una rete ampia di trasportatori per consegnare alle officine in tutta Europa.",
        howTitle: "Come funziona",
        howSub: "Ottenere il ricambio giusto è facile come 1, 2, 3.",
        step1: "Inviaci la tua richiesta",
        step1Text: "Indica il ricambio, il VIN e i dati principali del veicolo.",
        step2: "Cerchiamo nella nostra rete",
        step2Text: "Controlliamo migliaia di riferimenti presso demolitori e fornitori.",
        step3: "Ricevi il ricambio",
        step3Text: "Ti contattiamo su WhatsApp con prezzo, tempi e opzioni di trasporto.",
        aboutTitle: "Chi siamo",
        aboutText: "Sonver opera nel settore automotive da oltre 12 anni. Siamo nati come specialisti nel sourcing tecnico e oggi aiutiamo officine in tutta Europa a trovare ricambi originali usati in modo rapido e affidabile. Grazie alla nostra ampia rete di fornitori e trasportatori, il ricambio giusto arriva direttamente in officina.",
        privacyTitle: "Privacy & GDPR",
        privacyText: "Titolare: Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Finalità: rispondere alla tua richiesta e inviarti un’offerta. Base giuridica: misure precontrattuali su tua richiesta e nostro legittimo interesse al follow-up. Conservazione: 12 mesi dall’ultimo contatto. Destinatari: nessuna comunicazione salvo obbligo di legge o responsabili essenziali (hosting/WhatsApp) nello SEE. Diritti: accesso, rettifica, cancellazione, limitazione, opposizione, portabilità e reclamo all’autorità. Esercizio dei diritti: gdpr@sonver.eu."
      },
      pt: {
        live: "Disponível · Resposta rápida",
        headline: "As peças chegam. Os problemas desaparecem.",
        sub: "Peças usadas originais entregues diretamente à oficina.",
        company: "Oficina ou empresa",
        address: "Morada da oficina (rua, cidade, ilha)",
        model: "Marca e modelo",
        vin: "VIN (número de chassis)",
        part: "Peça necessária (lado, referência, etc.)",
        contact: "Seu contato (email, telefone ou nota)",
        hint: "Deixe qualquer forma de contato e retornamos com preço e disponibilidade.",
        contactError: "Deixe qualquer contacto para podermos responder.",
        submit: "Enviar pedido",
        uploading: "A carregar ficheiro...",
        uploadSuccess: "Ficheiro carregado com sucesso",
        uploadError: "Falha no carregamento",
        thankYouTitle: "Obrigado!",
        thankYouMsg: "Entraremos em contacto em breve com preço e disponibilidade.",
        whyTitle: "Porquê escolher-nos",
        whySub: "Graças à nossa rede, encontrar peças usadas torna-se rápido e simples.",
        find: "Encontramos por si",
        findText: "Não encontra a peça? Procuramo-la na nossa rede.",
        fast: "Resposta rápida",
        fastText: "Disponibilidade e preço em menos de 24 horas.",
        price: "Preços competitivos",
        priceText: "Acesso a peças usadas com preços alinhados ao mercado.",
        network: "Ampla rede de transportadoras",
        networkText: "Trabalhamos com uma ampla rede de transportadoras para entregar a oficinas em toda a Europa.",
        howTitle: "Como funciona",
        howSub: "Conseguir a peça certa é tão simples quanto 1, 2, 3.",
        step1: "Envie-nos o seu pedido",
        step1Text: "Indique a peça, o VIN e os dados principais do veículo.",
        step2: "Pesquisamos na nossa rede",
        step2Text: "Verificamos milhares de referências em sucateiros e fornecedores.",
        step3: "Receba a peça",
        step3Text: "Entramos em contacto via WhatsApp com preço, prazo e opções de transporte.",
        aboutTitle: "Sobre nós",
        aboutText: "A Sonver atua no setor automóvel há mais de 12 anos. Começámos como especialistas em sourcing técnico e hoje ajudamos oficinas em toda a Europa a encontrar peças originais usadas de forma rápida e fiável. Com a nossa ampla rede de fornecedores e transportadoras, a peça certa chega diretamente à sua oficina.",
        privacyTitle: "Privacidade & RGPD",
        privacyText: "Responsável: Sonver UAB (Kariu Kapų g. 19, Vilnius, LT) — gdpr@sonver.eu. Finalidade: responder ao pedido e enviar uma proposta. Base legal: medidas pré-contratuais a seu pedido e nosso interesse legítimo no acompanhamento. Conservação: 12 meses desde o último contacto. Destinatários: não partilhamos dados salvo obrigação legal ou subcontratantes essenciais (alojamento/WhatsApp) no EEE. Direitos: acesso, retificação, apagamento, limitação, oposição, portabilidade e reclamação à autoridade. Exercício de direitos: gdpr@sonver.eu."
      }
    };

    // Ensure logo renders even if the PNG fails to load from cache/CDN
    const heroLogo = document.getElementById('brandLogo');
    if (heroLogo) {
      heroLogo.addEventListener('error', () => {
        heroLogo.src = LOGO_FALLBACK;
      }, { once: true });
    }

    let currentLang = 'es';

    const uploadStatus = document.getElementById('uploadStatus');

    async function uploadFileWithProgress(file, t) {
      // Initialize status UI
      uploadStatus.textContent = t.uploading;
      uploadStatus.className = 'upload-status uploading';
      uploadStatus.style.display = 'block';

      const timeoutMs = 20000;

      return new Promise((resolve, reject) => {
        const xhr = new XMLHttpRequest();
        xhr.open('POST', UPLOAD_ENDPOINT);
        xhr.responseType = 'json';
        xhr.timeout = timeoutMs;

        const timestamp = Date.now();
        const safeName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_') || 'upload';

        const formData = new FormData();
        formData.append('file', file, `${timestamp}_${safeName}`);

        xhr.upload.onprogress = (event) => {
          if (event.lengthComputable) {
            const percent = Math.round((event.loaded / event.total) * 100);
            uploadStatus.textContent = `${t.uploading} (${percent}%)`;
          }
        };

        xhr.onload = () => {
          if (xhr.status >= 200 && xhr.status < 300) {
            const res = xhr.response || {};
            const url = res?.data?.url || res?.url;
            if (url) {
              resolve(url);
            } else {
              reject(new Error('missing_upload_url'));
            }
          } else {
            reject(new Error(`status_${xhr.status}`));
          }
        };

        xhr.onerror = () => reject(new Error('network_error'));
        xhr.ontimeout = () => reject(new Error('upload_timeout'));

        xhr.send(formData);
      });
    }

    // Detect mobile device
    function isMobile() {
      return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    // Update UI text based on language
    function updateTexts() {
      const t = translations[currentLang];

      // Form elements
      document.querySelector('.live-text').textContent = t.live;
      document.querySelector('.headline').textContent = t.headline;
      document.querySelector('.sub').textContent = t.sub;
      document.getElementById('company').placeholder = t.company;
      document.getElementById('address').placeholder = t.address;
      document.getElementById('model').placeholder = t.model;
      document.getElementById('vin').placeholder = t.vin;
      document.getElementById('part').placeholder = t.part;
      document.getElementById('contact').placeholder = t.contact;
      document.querySelector('.hint').textContent = t.hint;
      document.querySelector('.btn-text').textContent = t.submit;

      // Section titles and content
      document.querySelectorAll('.section-title')[0].textContent = t.whyTitle;
      document.querySelectorAll('.section-sub')[0].textContent = t.whySub;

      const cards = document.querySelectorAll('.cards')[0].querySelectorAll('.card');
      cards[0].querySelector('h3').textContent = t.find;
      cards[0].querySelector('p').textContent = t.findText;
      cards[1].querySelector('h3').textContent = t.fast;
      cards[1].querySelector('p').textContent = t.fastText;
      cards[2].querySelector('h3').textContent = t.price;
      cards[2].querySelector('p').textContent = t.priceText;
      cards[3].querySelector('h3').textContent = t.network;
      cards[3].querySelector('p').textContent = t.networkText;

      document.querySelectorAll('.section-title')[1].textContent = t.howTitle;
      document.querySelectorAll('.section-sub')[1].textContent = t.howSub;

      const steps = document.querySelectorAll('.step');
      steps[0].querySelector('h3').textContent = t.step1;
      steps[0].querySelector('p').textContent = t.step1Text;
      steps[1].querySelector('h3').textContent = t.step2;
      steps[1].querySelector('p').textContent = t.step2Text;
      steps[2].querySelector('h3').textContent = t.step3;
      steps[2].querySelector('p').textContent = t.step3Text;

      document.querySelectorAll('.section-title')[2].textContent = t.aboutTitle;
      document.querySelector('.about-text').textContent = t.aboutText;

      document.querySelectorAll('.section-title')[3].textContent = t.privacyTitle;
      document.querySelector('.privacy-text').textContent = t.privacyText;
    }

    // Set language
    function setLanguage(lang) {
      currentLang = lang;

      // Update active button
      document.querySelectorAll('.lang-switch button').forEach(btn => {
        btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
      });

      updateTexts();
      document.documentElement.setAttribute('lang', lang);
      localStorage.setItem('lang', lang);
    }

    // Initialize language
    function initLanguage() {
      const saved = localStorage.getItem('lang');
      const supported = ['es', 'en', 'de', 'lt', 'fr', 'it', 'pt'];

      const browserLocales = Array.isArray(navigator.languages) && navigator.languages.length
        ? navigator.languages
        : [navigator.language || ''];

      const intlLocale = (Intl.DateTimeFormat().resolvedOptions().locale || '').split('-')[0];

      const candidates = [saved, ...browserLocales, intlLocale]
        .filter(Boolean)
        .map(code => code.slice(0, 2).toLowerCase());

      const detected = candidates.find(code => supported.includes(code)) || 'es';
      setLanguage(detected);
    }

    // Language button handlers
    document.querySelectorAll('.lang-switch button').forEach(btn => {
      btn.addEventListener('click', () => {
        setLanguage(btn.getAttribute('data-lang'));
      });
    });

    // Form submission handler
    const form = document.getElementById('sonver-form');
    const contactInput = document.getElementById('contact');

    contactInput.addEventListener('input', () => {
      contactInput.classList.remove('invalid-input');
      contactInput.setCustomValidity('');
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const submitBtn = form.querySelector('button[type="submit"]');
      submitBtn.disabled = true;

      const t = translations[currentLang];

      // Get form values
      const company = document.getElementById('company').value.trim();
      const address = document.getElementById('address').value.trim();
      const model = document.getElementById('model').value.trim();
      const vin = document.getElementById('vin').value.trim();
      const part = document.getElementById('part').value.trim();
      const contact = contactInput.value.trim();

      contactInput.classList.remove('invalid-input');
      contactInput.setCustomValidity('');

      // Get IP address
      let clientIp = 'unknown';
      try {
        const controller = new AbortController();
        const ipTimeout = setTimeout(() => controller.abort(), 3000);

        const ipResponse = await fetch('https://api.ipify.org?format=json', {
          signal: controller.signal
        });
        clearTimeout(ipTimeout);

        const ipData = await ipResponse.json();
        clientIp = ipData.ip || 'unavailable';
      } catch (error) {
        console.log('IP fetch failed:', error);
        clientIp = 'unavailable';
      }

      // Handle file upload
      let fileUrl = 'no_file';
      const fileInput = document.getElementById('file');

      if (fileInput.files.length > 0) {
        const file = fileInput.files[0];

        try {
          fileUrl = await uploadFileWithProgress(file, t);

          // Show success
          uploadStatus.textContent = t.uploadSuccess;
          uploadStatus.className = 'upload-status success';

        } catch (error) {
          console.error('Upload error:', error);
          uploadStatus.textContent = `${t.uploadError} (${error.message || 'error'})`;
          uploadStatus.className = 'upload-status error';
          fileUrl = 'upload_failed';
        }
      }

      // Build WhatsApp message
      const timestamp = new Date().toISOString();
      const pageUrl = window.location.href;

      const message = `New incoming request for Sonver:

Company / Workshop: ${company}
Address: ${address}
Make & Model: ${model}
VIN: ${vin}
Requested part: ${part}
Contact (email / WhatsApp): ${contact}

File: ${fileUrl}
Language: ${currentLang.toUpperCase()}
Page: ${pageUrl}
Timestamp: ${timestamp}
Client IP: ${clientIp}`;

      // Send to WhatsApp
      const whatsappNumber = '34631577821';
      const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;

      // Open WhatsApp (works on both mobile and desktop without pop-up blockers)
      window.location.href = whatsappUrl;

      // Show thank you message
      setTimeout(() => {
        form.style.display = 'none';
        const thankYou = document.createElement('div');
        thankYou.className = 'thankyou fade';
        thankYou.innerHTML = `
          <h3>${t.thankYouTitle}</h3>
          <p>${t.thankYouMsg}</p>
        `;
        form.parentElement.appendChild(thankYou);
      }, 1000);
    });

    // Initialize on load
    initLanguage();
  </script>
</body>
</html>
